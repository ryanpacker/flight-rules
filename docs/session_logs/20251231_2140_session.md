# Session Log: 2024-12-31 21:40

## Session Goals

1. ✅ Create `prd.create` command with dual-mode support (conversational + one-shot)
2. ✅ Create `prd.clarify` command for refining specific PRD sections
3. ✅ Update prompts README to reference the new commands

## Related Specs

- Not tied to specific task group specs; this is new command functionality inspired by Spec Kit and ChatPRD

## Technical Approach

### Research Phase

Researched two external projects for inspiration:

1. **Spec Kit** (`github.com/github/spec-kit`)
   - `/speckit.specify` command focuses on "what" and "why", not "how"
   - `/speckit.clarify` command prompts for details on underspecified areas
   - Generates structured output (user stories, requirements, review checklist)

2. **ChatPRD** (`chatprd.ai`)
   - AI-driven PRD creation from prompts
   - Emphasis on pushing back when requirements are vague or unmeasurable
   - Template-based structure ensures consistency

### Design Decisions

1. **Dual-mode for prd.create**
   - Conversational mode (default): Interview through 6 PRD sections
   - One-shot mode: Generate draft from description, then offer to refine

2. **User-initiated clarification**
   - `prd.clarify` waits for user to specify which section to clarify
   - Does not auto-detect gaps (user preference)

## Key Decisions

1. **Reused conversational prompt persona** — The "senior PM" persona from `creation-conversational.md` is the foundation
2. **Commands over prompts** — Commands integrate better with Flight Rules workflow
3. **Markdown files only** — No TypeScript changes needed; commands are interpreted by AI agents

## Implementation Details

### prd.create.md

- Checks for existing PRD before creating
- Conversational mode walks through all 6 sections with probing questions
- One-shot mode generates draft and offers refinement options
- Validates consistency (goals vs non-goals, success criteria alignment)
- Saves to `docs/prd.md`

### prd.clarify.md

- Reads existing PRD and presents current structure
- Asks user which section(s) to clarify
- Section-specific probing questions
- Pushes back on vague/unmeasurable responses
- Checks for conflicts between sections
- Proposes updated content and waits for approval

### Key Behaviors (Both Commands)

- Push back on vagueness
- Ask "why" repeatedly
- Demand measurability
- Enforce non-goals
- Check consistency

## Code Areas Touched

- `payload/commands/prd.create.md` — new file
- `payload/commands/prd.clarify.md` — new file
- `payload/prompts/prd/README.md` — updated to reference commands

## Summary

Created two new PRD-focused commands that help users create and refine Product Requirements Documents:

- **prd.create**: Dual-mode PRD creation (conversational interview or one-shot from description)
- **prd.clarify**: Refine specific sections of existing PRD with targeted questions

Both commands embody the "senior PM" persona that pushes back on vagueness and demands measurable outcomes.

## Next Steps

1. Consider adding a `prd.review` command (like the implementation plan-review prompt)
2. Add gap detection mode to `prd.clarify` as optional feature
3. Consider integration with implementation spec generation


