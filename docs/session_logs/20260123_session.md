# Session Log: 2026-01-23

## Session Goals

- Create new `agents-md.refine` command for refactoring AGENTS.md files using progressive disclosure principles

## Related Specs

- Task Group: `3.2-implementation-commands.md` (Workflow Commands area)
- New task to be added

## Technical Approach

Create a prompt-based command that guides agents through a 5-step process:

1. **Find contradictions** — Scan AGENTS.md for conflicting instructions, ask user which to keep
2. **Identify essentials** — Extract only universal content (project description, package manager, build commands)
3. **Group the rest** — Organize remaining instructions into logical categories (TypeScript conventions, testing patterns, etc.)
4. **Create file structure** — Output minimal root AGENTS.md with links + separate category files
5. **Flag for deletion** — Identify redundant, vague, or obvious instructions

### File Locations

The command will be created in:
- `payload/commands/agents-md.refine.md` (canonical source)
- Copied to: `.claude/commands/`, `.cursor/commands/`, `.flight-rules/commands/`

### Command Pattern

Follow the established pattern from similar commands like `prd.clarify.md`:
- Read existing file first
- Present structured analysis
- Ask targeted questions
- Propose changes with user approval
- Execute changes only after confirmation

## Task Breakdown

1. Write the command prompt in `payload/commands/agents-md.refine.md`
2. Copy to the three command directories
3. Update any relevant documentation if needed

## Key Decisions

- Command name: `agents-md.refine` (follows naming pattern of other refine/clarify commands)
- Scope: Works on `.flight-rules/AGENTS.md` or any AGENTS.md file the user specifies

## Summary

Created the `agents-md.refine` command that guides users through refactoring their AGENTS.md files using progressive disclosure principles. The command follows a 5-step process: find contradictions, identify essentials, group remaining instructions, create file structure, and flag items for deletion.

## Code Areas Touched

- `payload/commands/agents-md.refine.md` — New command (canonical source)
- `.claude/commands/agents-md.refine.md` — Copy for Claude Code
- `.cursor/commands/agents-md.refine.md` — Copy for Cursor
- `.flight-rules/commands/agents-md.refine.md` — Copy for Flight Rules

## Next Steps

- Test the command on a real AGENTS.md file
- Consider adding to implementation spec if this becomes a core feature

